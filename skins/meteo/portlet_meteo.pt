<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="meteo">

<body>
<div metal:define-macro="portlet"
     tal:define="tool here/meteo_tool;
                 weather tool/getSimpleWeatherData;
                 portlet_type portlet_type | tool/getPortletType;">

<dl class="portlet" id="portlet-meteo">
  <dt class="portletHeader">
    <a tal:attributes="href string: $portal_url/meteo_details"
       i18n:translate="portlet_heading">El tiempo</a></dt>

  <dd class="portletItem odd"
      id="portlet-weather-location"
      tal:condition="weather/error | nothing"
      i18n:translate="portlet_error">
    Información no disponible.

    <div style="color: #FF7400"
         tal:condition="tool/adminLink"
         i18n:translate="portlet_check_location">
      Compruebe que el código de localización sea correcto.
    </div>
  </dd>
  
  <dd class="portletItem even"
      id="portlet-meteo-location"
      tal:condition="not: weather/error | nothing">
    <a href=""
       alt="Acceder a la información detallada"
       title="Acceder a la información detallada"
       tal:attributes="href string: $portal_url/meteo_details"
       tal:content="weather/location">Localización</a>
  </dd>
  
  <dd class="portletItem odd"
      id="portlet-weather-icon"
      tal:condition="not:weather/error|nothing">

    <tal:multiple tal:condition="python: portlet_type == 'multiple'">
    <table class="meteoForecast">
      <tal:loop repeat="dayData weather/forecast">
        <tr>
          <td>
            <span tal:content="dayData/dayOfWeek"></span>
          </td>
          <td rowspan="2">
            <img src=""
                 alt=""
                 title=""
                 tal:attributes="src dayData/iconUrl;
                                 alt dayData/iconAlternativeText;
                                 title dayData/iconAlternativeText" />
          </td>
        </tr>
        <tr>
          <td tal:define="maxTemp dayData/maxTemperature;
                          minTemp dayData/minTemperature">
            <span class="blue" tal:content="structure minTemp"></span>
            &nbsp;&frasl;&nbsp;
            <span class="red" tal:content="structure maxTemp"></span>
          </td>
        </tr>
      </tal:loop>
    </table>
    </tal:multiple>
    
    <tal:single tal:condition="python: portlet_type == 'single'">
    <table class="meteoForecast">
      <tal:block define="dayData weather/today">
        <tr>
          <td colspan="2">
            <span tal:content="dayData/dayOfWeek"></span>
          </td>
        </tr>
        <tr>
          <td colspan="2" class="centerText"
              tal:define="maxTemp dayData/maxTemperature;
                          minTemp dayData/minTemperature">
            <span class="blue" tal:content="structure minTemp"></span>
            &nbsp;&frasl;&nbsp;
            <span class="red" tal:content="structure maxTemp"></span>
          </td>
        </tr>
        <tr>
          <td class="centerText">
            <img src=""
                 alt=""
                 title=""
                 tal:attributes="src dayData/iconUrlAM;
                                 alt dayData/iconAlternativeTextAM;
                                 title dayData/iconAlternativeTextAM" />
          </td>
          <td class="centerText">
            <img src=""
                 alt=""
                 title=""
                 tal:attributes="src dayData/iconUrlPM;
                                 alt dayData/iconAlternativeTextPM;
                                 title dayData/iconAlternativeTextPM" />
          </td>
        </tr>
        <tr>
          <td class="discreet centerText"
              i18n:translate="portlet_am">
            Mañana
          </td>
          <td class="discreet centerText"
              i18n:translate="portlet_pm">
            Tarde
          </td>
        </tr>
      </tal:block>
    </table>
    </tal:single>

  </dd>
  <dd class="portletFooter discreet"
      style="text-align: right;"
      tal:condition="not: weather/error|nothing"
      i18n:translate="portlet_source">
    Fuente: INM
    <span i18n:name="inm-link">
    (<a href="http://www.inm.es"
        alt="Instituto Nacional de Meteorología"
        title="Instituto Nacional de Meteorología"
        i18n:attributes="alt inm;
                         title inm;">www.inm.es</a>)
    </span>
  </dd>
  <dd class="portletFooter"
      tal:condition="tool/adminLink"
      id="portlet-weather-settings">
    <a i18n:translate="change_settings"
       tal:attributes="href string: $portal_url/prefs_meteo_form">Cambiar configuración</a>
  </dd>
</dl>

</div>
</body>
</html>
